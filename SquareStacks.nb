(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7182,        221]
NotebookOptionsPosition[      6840,        204]
NotebookOutlinePosition[      7171,        219]
CellTagsIndexPosition[      7128,        216]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetCoord", "[", 
    RowBox[{"line_", ",", "split_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"line", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"split", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"line", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
         RowBox[{"line", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"line", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
      RowBox[{"split", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"line", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{"line", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SquareStacks", "[", 
    RowBox[{"lineRoot_", ",", "depth_", ",", "alpha_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "lineList", ",", "splits", ",", "points", ",", "len"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"splits", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], ",", "alpha"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"GetCoord", "[", 
          RowBox[{"lineRoot", ",", 
           RowBox[{"splits", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "alpha"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"points", ",", 
        RowBox[{"lineRoot", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"AppendTo", "[", 
       RowBox[{"points", ",", 
        RowBox[{"lineRoot", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"lineList", "=", 
       RowBox[{"{", "lineRoot", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"alpha", "+", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"lineList", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"points", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"points", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"points", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"points", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"points", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"points", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
                RowBox[{"points", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], "}"}]}],
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "lineList"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotSquares", "[", "lineList_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "gfxList", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gfxList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"Line", "[", 
           RowBox[{"lineList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "lineList", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "gfxList", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/aHC4t35lteOdgEh/0B0yEl/rgtAetmvJh4Q3fXE
XQBErxfvkQTRR4t/q4FoEYViLRD9qrlRH0Tvkm92BtEm13m8wOpkTcH0gS1i
QSD6nEZSOIh2upBeDqIvFWhVg2i/TyeaQLTQHqM2MN34ZA6IvjHpwDIQnXdu
+ioQndo95SiIbvAsfwii/RfkvAbR0camLBdB7suqANNfjmgoguiumHeqIHoX
P6sWiN5nqKcPomfFepuA6MifQb4gOoJnZzCITnOOigfRF9e/SQHRG+MjU0F0
y9lZmSCaM+4EmAYAfDGmlg==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SquareStacks", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", "1", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.693513479935153*^9, 3.693513497176897*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.8334413856273428`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.8334413856273428`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.8334413856273428`", ",", "0.16655861437265718`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.693513529503993*^9, 3.69351356067587*^9}]
}, Open  ]]
},
WindowSize->{958, 1022},
WindowMargins->{{1, Automatic}, {1, 26}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5223, 143, 446, "Input"],
Cell[CellGroupData[{
Cell[5806, 167, 322, 10, 34, "Input"],
Cell[6131, 179, 693, 22, 34, "Output"]
}, Open  ]]
}
]
*)

